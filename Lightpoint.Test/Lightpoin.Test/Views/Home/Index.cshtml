@using Lightpoin.Test.Web.Models
@model IEnumerable<StoreModel>
@{
    ViewData["Title"] = "Home Page";
}

<div style="margin-top: 20px;">

    <div class="row">
        <div class="text-center">
            <p style="font-size: 40px;">Stores</p>
            <div class="row">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="Home/AddStore">Add Store</button>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="Home/AddProductToStore">Add Product To Store</button>

            </div>
        </div>
    </div>
    <div class="row" style="margin-top: 20px;">
        <table id="StoreTable" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Address</th>
                    <th>Working Hours</th>
                </tr>
            </thead>
            <tbody>

                @{foreach (var store in Model)
                    {

                        <tr>
                            <th>@store.Id</th>
                            <th>
                                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="@Url.Action()Home/StoreProducts?productId=@store.Id">@store.Name</button>
                            </th>
                            <th>@store.Address</th>
                            <th>@store.WorkingHours</th>
                        </tr>

                    }

                }
            </tbody>
        </table>
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div id="StoreProducts"></div>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script>
        $(document).ready(function () {
            $('#StoreTable').DataTable();

            $('#ProductTable').DataTable();

            $('#exampleModal').on('show.bs.modal', function (event) {
                var button = $(event.relatedTarget);
                var url = button.data('whatever');

                $('#StoreProducts').load(url);
            });
            $('#AddStore').submit(function (event) {
                event.preventDefault();
                var data = $(this).serialize();
                var url = $(this).attr('action');
                $.post(url, data);
            });
            $('#AddProductToStore').submit(function (event) {
                event.preventDefault();
                var data = $(this).serialize();
                var url = $(this).attr('action');
                $.post(url, data);
            });

        });
    </script>


}
